(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     52838,       1246]
NotebookOptionsPosition[     52394,       1227]
NotebookOutlinePosition[     52772,       1243]
CellTagsIndexPosition[     52729,       1240]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["D", "+"], "[", 
    RowBox[{"D_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_"}], "]"}], ":=", 
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"D", "-", "1"}], ")"}], " ", 
     FractionBox[
      RowBox[{" ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Beta]"}], "]"}]}], 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Alpha]"}], "]"}]]}], "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"T", " ", 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "-", 
           RowBox[{"D", " ", 
            RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], ")"}], "2"], "D"], "-",
        "1"}], ")"}], " ", 
     FractionBox[
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"\[Beta]", "-", "\[Alpha]"}], ")"}]}], "]"}], 
      RowBox[{" ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["D", "+"], "[", 
    RowBox[{"p_", ",", "w_", ",", "i_"}], "]"}], ":=", 
   RowBox[{
    SubscriptBox["D", "+"], "[", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"i", ",", "2"}], "]"}], "+", "1"}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["T", "+"], "[", 
    RowBox[{
    "D_", ",", "T_", ",", "D2_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
     "\[Sigma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "D2"}], " ", 
     RowBox[{"Tan", "[", "\[Beta]", "]"}]}], "+", " ", 
    RowBox[{"\[Sigma]", 
     FractionBox[
      RowBox[{
       RowBox[{"D", " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "-", 
       RowBox[{"T", " ", 
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " "}]}], 
      RowBox[{"Cos", "[", "\[Beta]", "]"}]], " ", 
     SqrtBox[
      FractionBox["D2", "D"]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["Ts", "+"], "[", 
     RowBox[{"D_", ",", "T_", ",", "\[Alpha]_"}], "]"}], ":=", 
    RowBox[{"T", " ", "-", 
     RowBox[{"2", "D", " ", 
      RowBox[{"Tan", "[", "\[Alpha]", "]"}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"same", " ", "side", " ", "collision"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["T", "+"], "[", 
    RowBox[{"p_", ",", "D2_", ",", "w_", ",", "i_"}], "]"}], ":=", 
   RowBox[{
    SubscriptBox["T", "+"], "[", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "D2", ",", 
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"i", ",", "2"}], "]"}], "+", "1"}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "[", 
    RowBox[{"D_", ",", "T_", ",", "\[Alpha]_", ",", "\[Beta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Csc", "[", 
      RowBox[{"2", " ", "\[Alpha]"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Beta]"}], "]"}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Alpha]", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "-", "\[Beta]"}], ")"}]}], "]"}]}]}], ")"}], 
     " ", 
     SuperscriptBox["D", "2"]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"\[Alpha]", "-", "\[Beta]"}], ")"}]}], "]"}], " ", "T", " ", 
     "D"}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cot", "[", "\[Alpha]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Alpha]", "-", "\[Beta]"}], ")"}]}], "]"}]}], ")"}], " ", 
     SuperscriptBox["T", "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"Csc", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Alpha]", "-", 
          RowBox[{"2", " ", "\[Beta]"}]}], "]"}]}]}], ")"}], "D"}]}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"equation", " ", "for", " ", 
     SubscriptBox["D", "+"]}], "==", "0"}], " ", "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "[", 
    RowBox[{"p_", ",", "w_", ",", "i_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fL", "=", "L"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"D", ",", "T"}], "}"}], "=", "p"}], ",", 
     RowBox[{"j", "=", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{"i", ",", "2"}], "]"}], "+", "1"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"fL", "[", 
      RowBox[{"D", ",", "T", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}]}], 
    "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"lacuna", " ", "condition"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"D_", ",", "T_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"D", "-", "1"}], ")"}], "2"], "+", 
    SuperscriptBox["T", "2"], "-", "1"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"domain", " ", "condition"}], " ", "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", "p_", "]"}], ":=", 
   RowBox[{"R", "[", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"||", "--"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["F", "+"], "[", 
    RowBox[{"{", 
     RowBox[{"p_", ",", "w_", ",", "i_"}], "}"}], "]"}], ":=", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"main", " ", "irearation"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fD", "=", 
        SubscriptBox["D", "+"]}], ",", 
       RowBox[{"fT", "=", 
        SubscriptBox["T", "+"]}], ",", 
       RowBox[{"fR", "=", "R"}], ",", 
       RowBox[{"fTs", "=", 
        SubscriptBox["Ts", "+"]}], ",", "D2", ",", "D", ",", "T", ",", 
       "\[Sigma]", ",", "j", ",", "T2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D2", "=", 
       RowBox[{"fD", "[", 
        RowBox[{"p", ",", "w", ",", "i"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"D", ",", "T"}], "}"}], "=", "p"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"pahse", " ", "coordinates"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"j", "=", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"i", ",", "2"}], "]"}], "+", "1"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"angle", " ", "index"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", " ", 
      RowBox[{"(*", " ", "angles", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"domain", " ", "sign"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"D2", ">", "0"}], ",", 
         RowBox[{"fT", "[", 
          RowBox[{"p", ",", "D2", ",", "w", ",", "i"}], "]"}], ",", "T"}], 
        "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"find", " ", "T", " ", "on", " ", "other", " ", "side"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D2", ">", "0"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"fR", "[", 
            RowBox[{"D2", ",", "T2"}], "]"}], "r"}], "<", "0"}]}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"domain", " ", "condition"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"D2", ",", "T2"}], "}"}], ",", "w", ",", "j"}], "}"}], ",",
         " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "new", " ", "collision", " ", "on", " ", "other", " ", "side"}], " ",
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"w", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"same", " ", "side", " ", "condition"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"fT", "[", 
                 RowBox[{
                 "D", ",", "T", ",", "D", ",", "\[Alpha]", ",", "\[Alpha]", 
                  ",", 
                  RowBox[{"-", "1"}]}], "]"}]}], "}"}], ",", "w", ",", "i"}], 
             "}"}], ","}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{"new", " ", "same", " ", "side", " ", "result"}], " ", 
            "*)"}], "  ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"fTs", "[", 
               RowBox[{"D", ",", "T", ",", "\[Alpha]"}], "]"}]}], "}"}], ",", 
            "w", ",", "i"}], "}"}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"new", " ", "same", " ", "side", " ", "result"}], " ", 
           "*)"}], " ", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"p", ",", "w", ",", "i"}], "}"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{"collision", " ", "is", " ", "absent"}], " ", "*)"}], 
         "\[IndentingNewLine]", "]"}]}], "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.786026442796886*^9, 3.786026551029111*^9}, {
   3.7874187216415834`*^9, 3.7874187259241266`*^9}, {3.7875084838166056`*^9, 
   3.7875085171362553`*^9}, {3.7875092632539916`*^9, 3.787509421984486*^9}, {
   3.7875094758371325`*^9, 3.7875094764754257`*^9}, {3.78751130159091*^9, 
   3.7875113020995493`*^9}, 3.7875113825565343`*^9, {3.7875114328153276`*^9, 
   3.78751147251781*^9}, {3.7875115280990133`*^9, 3.7875115966538506`*^9}, {
   3.7875118749744306`*^9, 3.7875118951127176`*^9}, {3.787522970309588*^9, 
   3.7875230811134562`*^9}, {3.7875231166929584`*^9, 3.787523120270075*^9}, {
   3.787524808936717*^9, 3.787524847126959*^9}, {3.787524988882324*^9, 
   3.787525006577018*^9}, {3.787525037070567*^9, 3.787525092102877*^9}, {
   3.7875252337092237`*^9, 3.787525240712249*^9}, {3.7875252875069003`*^9, 
   3.787525287786968*^9}, {3.787525393629841*^9, 3.787525393823292*^9}, {
   3.7875255106758614`*^9, 3.7875255944501677`*^9}, {3.7875256729190674`*^9, 
   3.7875257193028536`*^9}, {3.7875257521441774`*^9, 3.787525825857112*^9}, 
   3.787525915188768*^9, {3.787525959125206*^9, 3.7875259893878093`*^9}, {
   3.787526050704601*^9, 3.7875260589934487`*^9}, 3.7875260997976084`*^9, {
   3.7875261872720194`*^9, 3.787526278989681*^9}, {3.7875263459505386`*^9, 
   3.7875263914964304`*^9}, {3.787526508360285*^9, 3.7875267078722525`*^9}, {
   3.787526743457324*^9, 3.7875268056480923`*^9}, {3.7875269023801603`*^9, 
   3.7875271056711955`*^9}, {3.787527304423368*^9, 3.787527334068209*^9}, {
   3.7875273669447594`*^9, 3.7875273785752363`*^9}, {3.787527630279927*^9, 
   3.7875276508833013`*^9}, {3.7875276860654836`*^9, 3.787527877777459*^9}, {
   3.787527988473849*^9, 3.7875280473992786`*^9}, {3.7875281966416006`*^9, 
   3.78752844750194*^9}, {3.787528487294696*^9, 3.7875285073580227`*^9}, 
   3.7875285395381913`*^9, 3.787528578249666*^9, {3.7875286992707877`*^9, 
   3.7875287456153593`*^9}, {3.787554694340521*^9, 3.787554713128774*^9}, {
   3.787554787145289*^9, 3.787554829327339*^9}, {3.787556017835157*^9, 
   3.7875561505763364`*^9}, {3.7875563496178446`*^9, 3.787556402776559*^9}, 
   3.787556490148915*^9, {3.787556846457879*^9, 3.7875569883036385`*^9}, 
   3.7875570286389303`*^9, {3.7875571267078743`*^9, 3.787557135767625*^9}, {
   3.7875577834112015`*^9, 3.787557812803999*^9}, {3.78755789903625*^9, 
   3.7875580756452637`*^9}, {3.787558192436718*^9, 3.7875582008029013`*^9}, {
   3.7875590883941784`*^9, 3.7875590915358768`*^9}, {3.787561346607195*^9, 
   3.787561350941243*^9}, {3.787561395822608*^9, 3.7875614574762335`*^9}, {
   3.7875615023482533`*^9, 3.7875616316024904`*^9}, {3.7875616743384457`*^9, 
   3.787561692923579*^9}, {3.787572537069422*^9, 3.787572583558866*^9}, 
   3.7875728799188333`*^9, {3.787573033238925*^9, 3.787573057701433*^9}, {
   3.7875731411985545`*^9, 3.7875731424383416`*^9}, {3.787573681999272*^9, 
   3.787573778342022*^9}, {3.787574579417625*^9, 3.7875747071601934`*^9}, {
   3.7875747881746693`*^9, 3.7875747944542413`*^9}, 3.787574840251261*^9, {
   3.7875758308864794`*^9, 3.7875758630592046`*^9}, {3.787575942334976*^9, 
   3.787575966600376*^9}, 3.7875759991150923`*^9, {3.787576402114216*^9, 
   3.787576419715252*^9}, {3.7875773957784095`*^9, 3.7875773972911286`*^9}, {
   3.7875802153556156`*^9, 3.7875802314181366`*^9}, {3.787580465850721*^9, 
   3.7875804696201777`*^9}, {3.7875808598084717`*^9, 3.787580863478675*^9}, {
   3.7875813402805295`*^9, 3.7875813438301525`*^9}, {3.7875814246083555`*^9, 
   3.7875815578979445`*^9}, {3.787601046117715*^9, 3.7876010652366962`*^9}, {
   3.787601120582687*^9, 3.7876011568865795`*^9}, {3.787601193413666*^9, 
   3.787601224730586*^9}, {3.7876012782095194`*^9, 3.787601292964655*^9}, {
   3.7876013930353007`*^9, 3.787601426666026*^9}, {3.7876019732841454`*^9, 
   3.787602023046097*^9}, {3.7876037477784615`*^9, 3.7876037772421293`*^9}, {
   3.787604193738101*^9, 3.787604197599606*^9}, {3.7876042838667603`*^9, 
   3.7876042867627354`*^9}, {3.787604332396103*^9, 3.787604350349822*^9}, {
   3.787604617374708*^9, 3.7876046765350494`*^9}, {3.7876048315729933`*^9, 
   3.787605040989439*^9}, {3.7876050825314865`*^9, 3.78760516840287*^9}, {
   3.7876052020192165`*^9, 3.787605207991948*^9}, {3.787605250808856*^9, 
   3.787605343597539*^9}, {3.7876053739051857`*^9, 3.7876053929963923`*^9}, {
   3.787605431613124*^9, 3.787605607723605*^9}, {3.7876100542513437`*^9, 
   3.787610095472706*^9}, {3.787611335771038*^9, 3.7876113361829376`*^9}, {
   3.7877886975900145`*^9, 3.78778869965385*^9}, {3.787789876688773*^9, 
   3.7877898819524093`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"X", "[", 
     RowBox[{"D_", ",", "T_", ",", "\[Alpha]_", ",", "\[Sigma]_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{"D", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "D", "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Alpha]"}], "]"}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Alpha]"}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"T", " ", "\[Sigma]", " ", 
           RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "+", 
          RowBox[{"D", " ", 
           RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], ")"}], "2"]}]}], 
     RowBox[{"D", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "\[Alpha]"}], "]"}]}]]}], ";", 
   RowBox[{
    RowBox[{"Y", "[", 
     RowBox[{"D_", ",", "T_", ",", "\[Alpha]_", ",", "\[Sigma]_"}], "]"}], ":=", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{" ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", "D"}], "+", 
          RowBox[{"\[Sigma]", " ", 
           RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", "T"}]}], ")"}], "2"]}],
       "D"]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"parabola", " ", "focus", " ", "coords"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fp", "[", 
    RowBox[{"p_", ",", "\[Alpha]_", ",", "\[Sigma]_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "\[Alpha]", ",", "\[Sigma]"}], 
      "]"}], ",", 
     RowBox[{"Y", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "\[Alpha]", ",", "\[Sigma]"}], 
      "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p_", ",", "w_", ",", "i_"}], "}"}], ",", "\[Sigma]_"}], "]"}], 
   ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\[Sigma]"}], "]"}], ",", 
     RowBox[{"Y", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\[Sigma]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", "[", 
    RowBox[{"D_", ",", "T_", ",", "\[Alpha]_", ",", "\[Sigma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"T", " ", "\[Sigma]", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Alpha]"}], "]"}]}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["D", "2"], "-", 
        SuperscriptBox["T", "2"]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "\[Alpha]"}], "]"}]}], 
     RowBox[{"2", "D"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", "[", 
    RowBox[{"p_", ",", "\[Alpha]_", ",", "\[Sigma]_"}], "]"}], ":=", 
   RowBox[{"t", "[", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "\[Alpha]", ",", "\[Sigma]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p_", ",", "w_", ",", "i_"}], "}"}], ",", "\[Sigma]_"}], "]"}], 
   ":=", 
   RowBox[{"t", "[", 
    RowBox[{"p", ",", 
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "\[Sigma]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fs", "[", "L_", "]"}], ":=", 
   RowBox[{"Most", "[", 
    RowBox[{"Fold", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#1", "==", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"t", "[", 
             RowBox[{"#2", ",", 
              RowBox[{"-", "1"}]}], "]"}], "}"}], "}"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Most", "[", "#1", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"F", "[", 
                RowBox[{"#2", ",", "1"}], "]"}], ",", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Last", "[", "#1", "]"}], ",", 
                 RowBox[{"t", "[", 
                  RowBox[{"#2", ",", "1"}], "]"}]}], "]"}]}], "}"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"t", "[", 
               RowBox[{"#2", ",", 
                RowBox[{"-", "1"}]}], "]"}], "}"}], "}"}]}], "]"}]}], "]"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", "}"}], ",", "L"}], "]"}], "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
     "focuses", " ", "and", " ", "crosspoints", " ", "of", " ", "the", " ", 
      RowBox[{"parabolas", ":", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "Y"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["t", "1"], ",", 
           SubscriptBox["t", "2"]}], "}"}]}], "}"}]}]}], ",", "..."}], "}"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]", "[", 
    RowBox[{"t_", ",", "Y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["t", "2"], 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"1", "-", "Y"}], ")"}]}]]}], "+", 
    FractionBox[
     RowBox[{"1", "+", "Y"}], "2"]}]}], ";", 
  RowBox[{
   RowBox[{"\[Xi]", "[", 
    RowBox[{"t_", ",", "X_"}], "]"}], ":=", 
   RowBox[{"t", "+", "X"}]}], ";", 
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{"t_", ",", "f_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]", "[", 
      RowBox[{"t", ",", 
       RowBox[{"f", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], ",", 
     RowBox[{"\[Eta]", "[", 
      RowBox[{"t", ",", 
       RowBox[{"f", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7860340319291515`*^9, 3.786034054424079*^9}, 
   3.7864538997531233`*^9, {3.786555059282523*^9, 3.78655508840341*^9}, {
   3.7874186363203306`*^9, 3.7874186378575735`*^9}, {3.787425619700197*^9, 
   3.7874256937242517`*^9}, {3.7874276422744603`*^9, 3.7874276434201*^9}, {
   3.7874280624955626`*^9, 3.7874280990094247`*^9}, {3.787431510030466*^9, 
   3.7874315584514003`*^9}, 3.7874316572135897`*^9, {3.787431726887012*^9, 
   3.787431727455106*^9}, 3.7874317613366084`*^9, {3.787433612180344*^9, 
   3.7874336324330425`*^9}, {3.7875081378170757`*^9, 
   3.7875081471902304`*^9}, {3.787529318768935*^9, 3.787529319124525*^9}, {
   3.787561982450489*^9, 3.7875620572228155`*^9}, {3.787576658810467*^9, 
   3.787576669485029*^9}, {3.7875774622187686`*^9, 3.787577553834135*^9}, {
   3.7875817718998365`*^9, 3.7875817774625435`*^9}, {3.7876114627057295`*^9, 
   3.787611556285365*^9}, {3.7876116109540195`*^9, 3.787611713784643*^9}, {
   3.7876321028517733`*^9, 3.787632121635417*^9}, {3.787632160351787*^9, 
   3.7876321738873215`*^9}, {3.787632228535037*^9, 3.7876322524728985`*^9}, {
   3.7876323053898335`*^9, 3.787632369860064*^9}, {3.7876324267651277`*^9, 
   3.78763244146612*^9}, {3.7876324748815374`*^9, 3.7876325001256475`*^9}, {
   3.787632558767582*^9, 3.7876326013150263`*^9}, {3.787632725326423*^9, 
   3.7876329572248993`*^9}, 3.7876329961337504`*^9, {3.7876332014043407`*^9, 
   3.78763320591617*^9}, {3.787633310060221*^9, 3.7876333138592715`*^9}, {
   3.787633354562071*^9, 3.787633359072333*^9}, {3.7876333974241357`*^9, 
   3.787633398765086*^9}, {3.7876334503813143`*^9, 3.787633465797656*^9}, {
   3.787633700161234*^9, 3.7876338052953577`*^9}, 3.787633942901015*^9, 
   3.7876340759147696`*^9, 3.7876346855332317`*^9, {3.787634732120848*^9, 
   3.7876347507214727`*^9}, {3.7876348235146427`*^9, 3.787634939092694*^9}, {
   3.787641756877375*^9, 3.787641812499934*^9}, {3.7876435063456*^9, 
   3.787643554693427*^9}, {3.7876448310978622`*^9, 3.787644833660556*^9}, {
   3.7876449506398315`*^9, 3.787645015266369*^9}, {3.7876450889548244`*^9, 
   3.787645162073447*^9}, 3.7876498694413595`*^9, {3.787650024140574*^9, 
   3.7876500524850607`*^9}, {3.7876501385976486`*^9, 3.7876501508316135`*^9}, 
   3.787660721311804*^9, 3.787661041568195*^9, {3.7877897192564435`*^9, 
   3.787789740370044*^9}, {3.7877902787873287`*^9, 3.787790296443967*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"NestList", "[", 
      RowBox[{
       SubscriptBox["F", "+"], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "s", ",", "r", ",", "b"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "s2", ",", "r2", ",", "b2"}], "}"}]}], 
          "}"}], ",", "i"}], "}"}], ",", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"n", ",", "m"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Row", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Column", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Show", "[", " ", 
           RowBox[{"(*", " ", 
            RowBox[{"phase", " ", "pictures"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ContourPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"R", "[", 
                RowBox[{"x", ",", "y"}], "]"}], "\[Equal]", "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"0", "-", "zp"}], ",", 
                RowBox[{"2", "+", "zp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", "zp"}], ",", 
                RowBox[{"1", "+", "zp"}]}], "}"}], ",", 
              RowBox[{"ContourStyle", "\[Rule]", "Black"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ContourPlot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"L", "[", 
                   RowBox[{"x", ",", "y", ",", 
                    RowBox[{
                    RowBox[{"#2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#1", ",", "2"}], "]"}], "+", "1"}], "]"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "#1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[Equal]", 
                  "0"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", 
                   RowBox[{"0", "-", "zp"}], ",", 
                   RowBox[{"2", "+", "zp"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"y", ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "-", "zp"}], ",", 
                   RowBox[{"1", "+", "zp"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ContourStyle", "\[Rule]", 
                  RowBox[{
                   RowBox[{"#2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"#1", ",", "2"}], "]"}], "+", "1"}], "]"}], "]"}],
                    "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], 
               "\[IndentingNewLine]", ")"}], "&"}], "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\[Alpha]", ",", "Red"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]", ",", "Blue"}], "}"}]}], "}"}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"First", "/@", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Take", "[", 
                  RowBox[{"data", ",", "n"}], "]"}], ",", 
                 RowBox[{"Function", "[", 
                  RowBox[{"u", ",", 
                   RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", "#"}]}], 
                  "]"}]}], "]"}]}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "zp"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"350", ",", "350"}], "}"}]}]}], "]"}], ")"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "2"}], "]"}], "+", "1"}], ",", "i"}], "}"}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"(*", " ", 
        RowBox[{"wedge", " ", "picture"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ParametricPlot", "[", 
            RowBox[{
             RowBox[{"P", "[", 
              RowBox[{"t", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "z"}]}], "]"}], ")"}], "&"}], "/@",
          "\[IndentingNewLine]", 
         RowBox[{"Fs", "@", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "m"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ContourPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "-", 
               RowBox[{"y", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "\[Equal]", 
              "0"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", "0", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", 
             RowBox[{"ContourStyle", "\[Rule]", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ")"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "Red", ",", "r"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "Blue", ",", "r2"}], "}"}]}], "}"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{"y", " ", "\[Equal]", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "0", ",", "1.1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", "Black"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"350", ",", "350"}], "}"}]}]}], "]"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "\"\<First side\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "0.398", ",", "\"\<\[Alpha]\>\""}], "}"}], ",",
      "0", ",", "\[Pi]"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "1", ",", "\"\<\[Alpha] sign\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "b", ",", " ", "True", ",", " ", "\"\<\[Alpha] double collision\>\""}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "1", ",", "\"\<\[Alpha] positive\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Beta]", ",", "0.764", ",", "\"\<\[Beta]\>\""}], "}"}], ",", 
     "0", ",", "\[Pi]"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s2", ",", "1", ",", "\"\<\[Beta] sign\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "b2", ",", " ", "False", ",", " ", "\"\<\[Beta] double collision\>\""}],
       "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r2", ",", "1", ",", "\"\<\[Beta] positive\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "10", ",", "\"\<Number of wedge iterations\>\""}], 
      "}"}], ",", "2", ",", "100", ",", "1"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "10", ",", "\"\<Number of phase iterations\>\""}], 
      "}"}], ",", "2", ",", "100000", ",", "1"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", 
       RowBox[{"fp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.773", ",", "  ", "0.066"}], "}"}], ",", "\[Alpha]"}], 
        "]"}]}], "}"}], ",", "Locator"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z", ",", " ", "1.5", ",", " ", "\"\<Zoom wedge\>\""}], "}"}], 
     ",", " ", "0.1", ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zp", ",", " ", "0", ",", " ", "\"\<Zoom phase\>\""}], "}"}], 
     ",", " ", "0", ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"SaveDefinitions", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7876605370919976`*^9, 3.78766057161234*^9}, {
   3.7876614769038553`*^9, 3.787661497126354*^9}, {3.787661550524125*^9, 
   3.7876615652857447`*^9}, {3.787661956560228*^9, 3.7876619674438763`*^9}, {
   3.787662013431319*^9, 3.7876620524890933`*^9}, {3.78766219212594*^9, 
   3.7876622489423037`*^9}, {3.787662279381178*^9, 3.787662297012456*^9}, {
   3.7876623436131873`*^9, 3.787662343745812*^9}, {3.787662384035138*^9, 
   3.7876623956372848`*^9}, {3.7876624326641245`*^9, 3.787662446770963*^9}, {
   3.787662484544157*^9, 3.787662496056196*^9}, {3.78766259068458*^9, 
   3.787662613137494*^9}, 3.7876627752791696`*^9, {3.787662998745374*^9, 
   3.7876630268339825`*^9}, {3.7876631383378906`*^9, 3.7876631778564777`*^9}, 
   3.7876632116144524`*^9, {3.7876632581628313`*^9, 3.787663260700511*^9}, {
   3.7876633060443583`*^9, 3.787663307352891*^9}, {3.787663348189828*^9, 
   3.7876634010193634`*^9}, {3.7876634701900373`*^9, 3.787663495387952*^9}, {
   3.7876636334676557`*^9, 3.787663646733197*^9}, {3.7876637523135448`*^9, 
   3.787663809889305*^9}, {3.7876643115894256`*^9, 3.78766434068287*^9}, {
   3.787664520859378*^9, 3.7876646533766737`*^9}, {3.7876650475155325`*^9, 
   3.7876650478506365`*^9}, 3.787665307230883*^9, {3.787665352045832*^9, 
   3.787665384856041*^9}, {3.7876659602909203`*^9, 3.787666007309553*^9}, {
   3.7876660465969057`*^9, 3.7876661449824815`*^9}, {3.787666176307602*^9, 
   3.787666200134575*^9}, {3.7876662687885556`*^9, 3.787666272074691*^9}, {
   3.787666579709588*^9, 3.787666593580142*^9}, {3.787666672601372*^9, 
   3.78766681042708*^9}, {3.7876669488081756`*^9, 3.7876670671774006`*^9}, {
   3.787667131083743*^9, 3.7876672375729933`*^9}, {3.787667298064599*^9, 
   3.787667306836511*^9}, {3.7876677344864244`*^9, 3.7876678212451315`*^9}, {
   3.7876680718795567`*^9, 3.787668087704139*^9}, {3.7877805596021013`*^9, 
   3.787780561882843*^9}, {3.787780641023415*^9, 3.787780650993894*^9}, {
   3.787780692989011*^9, 3.7877807979534054`*^9}, {3.7877809423285*^9, 
   3.787780965851195*^9}, {3.787781019241756*^9, 3.787781033102729*^9}, {
   3.787781101781921*^9, 3.787781260020524*^9}, {3.7877813141963744`*^9, 
   3.7877813463774147`*^9}, {3.787781393097238*^9, 3.7877814118108177`*^9}, {
   3.787781539730483*^9, 3.787781672409142*^9}, {3.787782028052947*^9, 
   3.787782034283224*^9}, {3.787782369312619*^9, 3.7877823825274363`*^9}, {
   3.7877824157734995`*^9, 3.7877824175355043`*^9}, {3.787783763101544*^9, 
   3.787783785274763*^9}, {3.787783843355576*^9, 3.7877838793409653`*^9}, 
   3.787783916926882*^9, {3.78778395865256*^9, 3.7877839587173867`*^9}, {
   3.7877840118417845`*^9, 3.7877840816793175`*^9}, {3.7877841492905083`*^9, 
   3.787784178222725*^9}, {3.7877845011955266`*^9, 3.787784512080609*^9}, {
   3.787784552755868*^9, 3.787784557060562*^9}, {3.7877845895188766`*^9, 
   3.787784683649537*^9}, {3.7877848788756022`*^9, 3.787784953548164*^9}, {
   3.7877850941599846`*^9, 3.787785104889207*^9}, {3.7877851747154775`*^9, 
   3.787785217304388*^9}, 3.7877852666801977`*^9, {3.787785314346506*^9, 
   3.787785340246831*^9}, {3.7877854188944564`*^9, 3.78778545722338*^9}, {
   3.7877855875826283`*^9, 3.7877856127791276`*^9}, {3.787785754842817*^9, 
   3.7877857670974216`*^9}, {3.787785946904681*^9, 3.787785984792514*^9}, {
   3.7877862220536156`*^9, 3.7877862543723745`*^9}, {3.78778644939845*^9, 
   3.7877864872007184`*^9}, {3.787786662594516*^9, 3.7877867946435547`*^9}, {
   3.7877868279582376`*^9, 3.7877869192828465`*^9}, {3.7877869666422267`*^9, 
   3.7877869672531443`*^9}, {3.787787011907651*^9, 3.7877870583324413`*^9}, {
   3.7877871038614073`*^9, 3.787787145435953*^9}, {3.7877872037478347`*^9, 
   3.787787226742584*^9}, 3.7877872617811213`*^9, 3.7877873715890007`*^9, {
   3.787787637406891*^9, 3.787787677680889*^9}, {3.7877878046674056`*^9, 
   3.7877878141712074`*^9}, {3.787787920220192*^9, 3.7877879635646653`*^9}, {
   3.7877882139596624`*^9, 3.787788247881546*^9}, {3.787788298260065*^9, 
   3.787788337332411*^9}, {3.787788370549567*^9, 3.7877883796409054`*^9}, {
   3.7877892772316275`*^9, 3.7877893163388395`*^9}, {3.7877893485832515`*^9, 
   3.78778935288041*^9}, {3.787790334379799*^9, 3.787790360419445*^9}, {
   3.787790460758142*^9, 3.7877904669593315`*^9}, {3.787790693552415*^9, 
   3.787790715486025*^9}, {3.787790750388789*^9, 3.7877907521911273`*^9}, {
   3.787790841685713*^9, 3.7877908495130363`*^9}, {3.7877909477267885`*^9, 
   3.7877909484216714`*^9}, {3.7877909942583904`*^9, 
   3.7877910502087975`*^9}, {3.787792173162839*^9, 3.7877921754956512`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`b$$ = True, $CellContext`b2$$ = 
    False, $CellContext`i$$ = 1, $CellContext`m$$ = 25, $CellContext`n$$ = 
    5504, $CellContext`p$$ = {
    1.0290000000000001`, -0.28800000000000003`}, $CellContext`r$$ = 
    1, $CellContext`r2$$ = 1, $CellContext`s$$ = 1, $CellContext`s2$$ = 
    1, $CellContext`z$$ = 1.5, $CellContext`zp$$ = 
    0, $CellContext`\[Alpha]$$ = 0.398, $CellContext`\[Beta]$$ = 0.764, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`i$$], 1, "First side"}, {1, 2}}, {{
       Hold[$CellContext`\[Alpha]$$], 0.398, "\[Alpha]"}, 0, Pi}, {{
       Hold[$CellContext`s$$], 1, "\[Alpha] sign"}, {1, -1}}, {{
       Hold[$CellContext`b$$], True, "\[Alpha] double collision"}, {
      True, False}}, {{
       Hold[$CellContext`r$$], 1, "\[Alpha] positive"}, {1, -1}}, {{
       Hold[$CellContext`\[Beta]$$], 0.764, "\[Beta]"}, 0, Pi}, {{
       Hold[$CellContext`s2$$], 1, "\[Beta] sign"}, {1, -1}}, {{
       Hold[$CellContext`b2$$], False, "\[Beta] double collision"}, {
      True, False}}, {{
       Hold[$CellContext`r2$$], 1, "\[Beta] positive"}, {1, -1}}, {{
       Hold[$CellContext`m$$], 10, "Number of wedge iterations"}, 2, 100, 
      1}, {{
       Hold[$CellContext`n$$], 10, "Number of phase iterations"}, 2, 100000, 
      1}, {{
       Hold[$CellContext`p$$], {1.2864917307672556`, 0.03569871513776516}}, 
      Automatic}, {{
       Hold[$CellContext`z$$], 1.5, "Zoom wedge"}, 0.1, 5}, {{
       Hold[$CellContext`zp$$], 0, "Zoom phase"}, 0, 5}}, Typeset`size$$ = {
    829., {384.5, 391.5}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i$4729812$$ = 
    False, $CellContext`\[Alpha]$4729813$$ = 0, $CellContext`s$4729814$$ = 
    False, $CellContext`b$4729815$$ = False, $CellContext`r$4729816$$ = 
    False, $CellContext`\[Beta]$4729817$$ = 0, $CellContext`s2$4729818$$ = 
    False, $CellContext`b2$4729819$$ = False, $CellContext`r2$4729820$$ = 
    False, $CellContext`m$4729821$$ = 0, $CellContext`n$4729822$$ = 
    0, $CellContext`z$4729823$$ = 0, $CellContext`zp$4729824$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`b$$ = True, $CellContext`b2$$ = 
        False, $CellContext`i$$ = 1, $CellContext`m$$ = 10, $CellContext`n$$ = 
        10, $CellContext`p$$ = {1.2864917307672556`, 
         0.03569871513776516}, $CellContext`r$$ = 1, $CellContext`r2$$ = 
        1, $CellContext`s$$ = 1, $CellContext`s2$$ = 1, $CellContext`z$$ = 
        1.5, $CellContext`zp$$ = 0, $CellContext`\[Alpha]$$ = 
        0.398, $CellContext`\[Beta]$$ = 0.764}, "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$4729812$$, False], 
        Hold[$CellContext`\[Alpha]$$, $CellContext`\[Alpha]$4729813$$, 0], 
        Hold[$CellContext`s$$, $CellContext`s$4729814$$, False], 
        Hold[$CellContext`b$$, $CellContext`b$4729815$$, False], 
        Hold[$CellContext`r$$, $CellContext`r$4729816$$, False], 
        Hold[$CellContext`\[Beta]$$, $CellContext`\[Beta]$4729817$$, 0], 
        Hold[$CellContext`s2$$, $CellContext`s2$4729818$$, False], 
        Hold[$CellContext`b2$$, $CellContext`b2$4729819$$, False], 
        Hold[$CellContext`r2$$, $CellContext`r2$4729820$$, False], 
        Hold[$CellContext`m$$, $CellContext`m$4729821$$, 0], 
        Hold[$CellContext`n$$, $CellContext`n$4729822$$, 0], 
        Hold[$CellContext`z$$, $CellContext`z$4729823$$, 0], 
        Hold[$CellContext`zp$$, $CellContext`zp$4729824$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`data = NestList[
          
          SubPlus[$CellContext`F], {$CellContext`p$$, \
{{$CellContext`\[Alpha]$$, $CellContext`s$$, $CellContext`r$$, \
$CellContext`b$$}, {$CellContext`\[Beta]$$, $CellContext`s2$$, \
$CellContext`r2$$, $CellContext`b2$$}}, $CellContext`i$$}, 
          Max[$CellContext`n$$, $CellContext`m$$]]; Row[
         Column[
          Map[Show[
            
            ContourPlot[$CellContext`R[$CellContext`x, $CellContext`y] == 
             0, {$CellContext`x, 0 - $CellContext`zp$$, 
              2 + $CellContext`zp$$}, {$CellContext`y, -1 - $CellContext`zp$$,
               1 + $CellContext`zp$$}, ContourStyle -> Black], 
            (ContourPlot[$CellContext`L[$CellContext`x, $CellContext`y, 
               Part[
                Part[#2, Mod[#, 2] + 1], 1], 
               Part[
                Part[#2, #], 1]] == 
             0, {$CellContext`x, 0 - $CellContext`zp$$, 
              2 + $CellContext`zp$$}, {$CellContext`y, -1 - $CellContext`zp$$,
               1 + $CellContext`zp$$}, ContourStyle -> Part[
               Part[#2, Mod[#, 2] + 1], 2]]& )[#, {{$CellContext`\[Alpha]$$, 
               Red}, {$CellContext`\[Beta]$$, Blue}}], 
            ListPlot[
             Map[First, 
              Select[
               Take[$CellContext`data, $CellContext`n$$], 
               Function[$CellContext`u, Part[$CellContext`u, 3] != #]]], 
             PlotRange -> $CellContext`zp$$], ImageSize -> {350, 350}]& , {
           Mod[$CellContext`i$$, 2] + 1, $CellContext`i$$}]], 
         Show[
          Map[ParametricPlot[
            $CellContext`P[$CellContext`t, 
             Part[#, 1]], {$CellContext`t, 
             Part[
              Part[#, 2], 1], 
             Part[
              Part[#, 2], 2]}, PlotRange -> $CellContext`z$$]& , 
           $CellContext`Fs[
            Take[$CellContext`data, $CellContext`m$$]]], 
          Map[ContourPlot[$CellContext`x Sin[
                Part[#, 1]] - $CellContext`y Cos[
               Part[#, 1]] == 
            0, {$CellContext`x, -10, 10}, {$CellContext`y, 0, 
             Part[#, 3]}, ContourStyle -> 
            Part[#, 2]]& , {{$CellContext`\[Alpha]$$, 
             Red, $CellContext`r$$}, {$CellContext`\[Beta]$$, 
             Blue, $CellContext`r2$$}}], 
          
          ContourPlot[$CellContext`y == 
           1, {$CellContext`x, -3, 3}, {$CellContext`y, 0, 1.1}, ContourStyle -> 
           Black], ImageSize -> {350, 350}]]), 
      "Specifications" :> {{{$CellContext`i$$, 1, "First side"}, {1, 
         2}}, {{$CellContext`\[Alpha]$$, 0.398, "\[Alpha]"}, 0, 
         Pi}, {{$CellContext`s$$, 1, "\[Alpha] sign"}, {
         1, -1}}, {{$CellContext`b$$, True, "\[Alpha] double collision"}, {
         True, False}}, {{$CellContext`r$$, 1, "\[Alpha] positive"}, {
         1, -1}}, {{$CellContext`\[Beta]$$, 0.764, "\[Beta]"}, 0, 
         Pi}, {{$CellContext`s2$$, 1, "\[Beta] sign"}, {
         1, -1}}, {{$CellContext`b2$$, False, "\[Beta] double collision"}, {
         True, False}}, {{$CellContext`r2$$, 1, "\[Beta] positive"}, {
         1, -1}}, {{$CellContext`m$$, 10, "Number of wedge iterations"}, 2, 
         100, 1}, {{$CellContext`n$$, 10, "Number of phase iterations"}, 2, 
         100000, 1}, {{$CellContext`p$$, {1.2864917307672556`, 
          0.03569871513776516}}, Automatic, ControlType -> 
         Locator}, {{$CellContext`z$$, 1.5, "Zoom wedge"}, 0.1, 
         5}, {{$CellContext`zp$$, 0, "Zoom phase"}, 0, 5}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{1287., {423., 430.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.787665067774153*^9, {3.787665309382203*^9, 3.787665323024048*^9}, {
   3.7876653545175147`*^9, 3.787665385652122*^9}, 3.7876660553665495`*^9, 
   3.7876660971465*^9, {3.787666138397422*^9, 3.7876661460620065`*^9}, 
   3.7876662024006815`*^9, 3.787666275002149*^9, 3.7876665970878444`*^9, {
   3.787666775261984*^9, 3.7876668115563087`*^9}, {3.787667030538458*^9, 
   3.787667068277444*^9}, 3.787667134189313*^9, {3.7876671644530106`*^9, 
   3.7876671811012487`*^9}, 3.787667239003177*^9, 3.787667309121231*^9, 
   3.7876678229127455`*^9, 3.787668089457819*^9, 3.7877610882786274`*^9, 
   3.787780569596564*^9, {3.787780642582003*^9, 3.78778065229907*^9}, {
   3.7877807562452393`*^9, 3.7877807995413585`*^9}, 3.787780966507888*^9, {
   3.787781229004101*^9, 3.7877812610425367`*^9}, {3.7877813167465725`*^9, 
   3.7877813478888845`*^9}, 3.787781412288541*^9, 3.7877816345717936`*^9, 
   3.787781672716297*^9, 3.787782034803832*^9, 3.787782383547681*^9, 
   3.787782418264948*^9, 3.7877837010905*^9, 3.787783786100029*^9, {
   3.7877838468295145`*^9, 3.7877838647637725`*^9}, 3.787783960195508*^9, 
   3.787784085335125*^9, {3.787784171082035*^9, 3.7877841788560314`*^9}, 
   3.787784502605854*^9, 3.7877845588349752`*^9, {3.7877846632237573`*^9, 
   3.7877846858906603`*^9}, 3.787784956503292*^9, 3.787785105778631*^9, 
   3.787785267909276*^9, {3.7877853161003184`*^9, 3.787785340575982*^9}, {
   3.7877854205534997`*^9, 3.787785443282325*^9}, 3.7877855947091117`*^9, 
   3.7877859781360493`*^9, {3.787786225542821*^9, 3.7877862552388625`*^9}, 
   3.787786489592827*^9, 3.7877869296431904`*^9, 3.7877869687467427`*^9, {
   3.787787035892684*^9, 3.7877870594195623`*^9}, 3.7877871460472913`*^9, 
   3.787787232730852*^9, 3.787787374840439*^9, 3.7877876410061626`*^9, 
   3.7877877103753223`*^9, 3.787787814878317*^9, {3.787787949888815*^9, 
   3.7877879640532165`*^9}, 3.7877882532078*^9, {3.7877883308414087`*^9, 
   3.787788338605426*^9}, 3.7877883971309433`*^9, 3.7877892815824165`*^9, 
   3.787789317481206*^9, 3.787789353741667*^9, {3.787789698198141*^9, 
   3.787789722857649*^9}, 3.787790283898282*^9, 3.7877903618371015`*^9, 
   3.787790467849772*^9, 3.7877907528354053`*^9, 3.787790850797638*^9, 
   3.787790950350115*^9, {3.7877910228485518`*^9, 3.7877910511582603`*^9}, 
   3.787792175936283*^9}]
}, Open  ]]
},
WindowSize->{1428, 873},
WindowMargins->{{140, Automatic}, {46, Automatic}},
Magnification:>1.1 Inherited,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 16677, 419, 715, "Input"],
Cell[17238, 441, 9283, 250, 377, "Input"],
Cell[CellGroupData[{
Cell[26546, 695, 15510, 349, 649, "Input"],
Cell[42059, 1046, 10319, 178, 887, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
